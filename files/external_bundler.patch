From b883f3b5971350a7f9f73406de2d5ca9fe56cfea Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?S=C3=B6nke=20Behrendt?= <thesoenke@outlook.com>
Date: Sat, 12 Nov 2016 01:36:00 +0100
Subject: [PATCH 1/1] External bundler

---
 bin/vagrant            | 7 +++----
 lib/vagrant/bundler.rb | 3 +--
 2 files changed, 4 insertions(+), 6 deletions(-)

diff --git a/bin/vagrant b/bin/vagrant
index 43ec25b..6825a20 100755
--- a/bin/vagrant
+++ b/bin/vagrant
@@ -66,6 +66,8 @@ end
 
 # Setup our dependencies by initializing Bundler. If we're using plugins,
 # then also initialize the paths to the plugins.
+load_path = []
+$LOAD_PATH.each { |path| load_path << path }
 begin
   require "bundler"
 rescue Errno::EINVAL
@@ -109,6 +111,7 @@ rescue Bundler::VersionConflict => e
   $stderr.puts e.message
   exit 1
 end
+load_path.each { |path| $LOAD_PATH.push(path) unless $LOAD_PATH.include?(path) }
 
 # Stdout/stderr should not buffer output
 $stdout.sync = true
@@ -179,10 +182,6 @@ begin
   logger.debug("Creating Vagrant environment")
   env = Vagrant::Environment.new(opts)
 
-  if !Vagrant.in_installer? && !Vagrant.very_quiet?
-    # If we're not in the installer, warn.
-    env.ui.warn(I18n.t("vagrant.general.not_in_installer") + "\n", prefix: false)
-  end
 
   begin
     # Execute the CLI interface, and exit with the proper error code
diff --git a/lib/vagrant/bundler.rb b/lib/vagrant/bundler.rb
index ff152f7..47d5281 100644
--- a/lib/vagrant/bundler.rb
+++ b/lib/vagrant/bundler.rb
@@ -20,8 +20,7 @@ module Vagrant
     end
 
     def initialize
-      @enabled = true if ENV["VAGRANT_INSTALLER_ENV"] ||
-        ENV["VAGRANT_FORCE_BUNDLER"]
+      @enabled = true 
       @enabled  = !::Bundler::SharedHelpers.in_bundle? if !@enabled
       @monitor  = Monitor.new
 
-- 
2.10.2

